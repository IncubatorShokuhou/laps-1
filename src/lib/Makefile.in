#
#

LAPSROOT=@top_srcdir@
INSTALLROOT=@prefix@

# Specify Fortran, C, and loader options for default SUN configuration.

CC=@CC@

CFLAGS=@CFLAGS@ $(INC) @OPTIMIZE@ 

FC       = @FC@

FFLAGS = @FFLAGS@ $(INC) @OPTIMIZE@

# Define pre-processor command line options for .F files.

CPP = @CPP@
CPPFLAGS = @CPPFLAGS@

# Define include paths.

INC = -I$(LAPSROOT)/src/include -I@NETCDFINC@

# Define local library name, this houses the module's code
.SUFFIXES:
.SUFFIXES: .o .c .f .a

LIB      = liblaps.a
DEBUGLIB = libdebuglaps.a

# Define other variables 

AR  = @ARCHIVE@
RANLIB   = @RANLIB@

# Define all source code to be compiled and placed in local library.

SRC	= cio.c \
	  rwl_v3.c \
          fort2c_str.c \
          static_routines.c \
          waiting_c.c  \
          fsystem_dum.f \
          add.f \
          addcon.f \
          advect.f \
          aski4tim_gg.f \
          array_diagnosis.f \
          atan3.f \
          atan3d.f \
          barnes_multivariate.f \
          barnes_univariate.f \
          bilinear_interp.f \
          block_data.f \
          c_time2fname.c \
          check_nan.f \
          check_nan1.f \
          check_nan2.f \
          check_nan3.f \
          constant.f \
          convc2f.f \
          conversions.f \
          convf2c.f \
          convf2k.f \
          convk2f.f \
          convkt2ms.f \
          convm2miles.f \
          convmiles2m.f \
          convms2kt.f \
          cv_asc_i4time.f \
          cv_i4tim_asc_lp.f \
          diff.f \
          downcase.f \
          esat1.f \
          fflxc.f \
          filename13.f \
          filter_filenames.f \
          fname_conversions.f \
          get_cloud_deriv.f \
          get_dir_length.f \
          get_directory.f \
          get_domain_perimeter.f \
          get_file_names.f \
          get_file_time.f \
          get_heights_hydrostatic.f \
          get_lowref.f \
          get_maps_lapsgrid.f \
          get_maxref.f \
          get_maxtops.f \
          get_pres_3d.f \
          get_radar_max_pd.f \
          get_static_info.f \
          get_systime.f \
          getcld3d.f \
          getradar.f \
          gettmp2d.f \
          gettmp3d.f \
          getuv3d.f \
          getw3d.f \
          gridconv.f \
          ground_temp.f \
          hum.f \
          i4time_asc_gg.f \
          i4time_fname_lp.f \
          interp.f \
          interpolate_3dfield.f \
          laps_io.f \
          laps_thermo.f \
          lapsgrid.f \
          latlon_to_rlaps.f \
          libdummies.f \
          machine_dependent.F \
          make_rh.f \
          make_ssh.f \
          make_td.f \
          make_fnam_lp.f \
          map_proj.f \
          meanlapse.f \
          meanpres.f \
          move.f \
          multar.f \
          multcon.f \
          my_show_timer.f \
          newreadobs.f \
          normalize.f \
          pcpcnc.f \
          prof_cdf.f \
          psatoz.f \
          radar_qc.f \
          radar_to_latlon.f \
          razm_lat_lon_gm.f \
          readlaps.f \
          rd_laps_static.f \
          read-laps-static.f \
          read_surface_obs.f \
          read_surface_old.f \
          readlapsdata.f \
          readlapsheader.f \
          rfill.f \
          rootfind.f \
          smf_wisp91.f \
          smf_wisp92.f \
          smooth_cross_laps.f \
          snooze_gg.f \
          ssh2.f \
          subcon.f \
          sunfuncs.f \
          time_now.c \
          trig_dum.f \
          upcase.f \
          vectors.f \
          vis2albedo.f \
          visg2log.f \
          viss2log.f \
          vlog2vis.f \
          vv.f \
          wait_for_data.f \
          wfo_fname_conversions.f \
          windspeed.f \
          writelaps.f \
          writelapsdata.f \
          wrt_laps_static.f \
          zero.f \
          zr.f \
          zs.f \
          ztopsa.f \
          getfilenames_c.c \
          i4time_now_gg.c \
          regex.c \
          alloca.c \
          xmalloc.c \
          nan.c



ARCHIVE = $(LIB)($(addsuffix .o, $(basename $(SRC))))
DBARCHIVE = $(DEBUGLIB)($(addsuffix .o, $(basename $(SRC))))


all: lib

lib: $(LIB)

$(LIB): $(ARCHIVE) 
	$(RANLIB) $@

debug: 
	$(RM) *.o; $(MAKE) lib LIB='$(DEBUGLIB)' ARCHIVE='$(DBARCHIVE)' CFLAGS='@CFLAGS@ $(INC) -g -C -DDEBUG=1' \
        FFLAGS='@FFLAGS@ $(INC) -g -C'

install: lib

clean:
	$(RM) $(LIB) $(DEBUGLIB) *.o *~ *#

distclean: clean
	$(RM) Makefile

%.f : %.F
	$(RM) $*.f
	$(CPP) $(CPPFLAGS) $< 
	mv $*.i $*.f


barnes_multivariate.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

barnes_univariate.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

block_data.f:  $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

conversions.f:  $(LAPSROOT)/src/include/lapsparms.inc $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

get_cloud_deriv.f:  $(LAPSROOT)/src/include/lapsparms.inc $(LAPSROOT)/src/include/laps_cloud.inc $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

get_directory.f:  $(LAPSROOT)/src/include/get_directory.inc@F77INC@

get_heights_hydrostatic.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_lowref.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_maps_lapsgrid.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_maxref.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_maxtops.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_radar_max_pd.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

get_static_info.f:  $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

getcld3d.f:  $(LAPSROOT)/src/include/laps_cloud.inc@F77INC@

getfilenames_c.c:  $(LAPSROOT)/src/include/regex.h

getradar.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

gettmp2d.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

gettmp3d.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

getuv3d.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

getw3d.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

insert_tsnd.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

laps_io.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

laps_thermo.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

lapsgrid.f:  $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

latlon_to_rlaps.f:  $(LAPSROOT)/src/include/lapsparms.cmn@F77INC@

prof_cdf.f:  @NETCDFINC@/netcdf.inc $(LAPSROOT)/src/include/prof_cdf_common.inc@F77INC@

puttmpanal.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

radar_to_latlon.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

read_tsnd.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

rwl_v3.c:  @NETCDFINC@/netcdf.h

regex.c:  $(LAPSROOT)/src/include/regex.h

rfill.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

smf_wisp91.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

static_routines.c:  @NETCDFINC@/netcdf.h 

zr.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

zs.f:  $(LAPSROOT)/src/include/lapsparms.inc@F77INC@

